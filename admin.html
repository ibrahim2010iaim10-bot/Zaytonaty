<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Zaytonaty</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <a href="index.html" class="logo">Zaytonaty ðŸ”’</a>
        <nav>
            <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <a href="products.html">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
            <a href="cart.html">Ø§Ù„Ø³Ù„Ø© <span id="cart-count">0</span></a>
            <a href="admin.html">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
        </nav>
    </header>

    <div id="auth-section" style="text-align:center; padding: 100px;">
        <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h2>
        <input type="email" id="email" placeholder="Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„" style="max-width:300px;"><br>
        <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="max-width:300px;"><br>
        <button class="cta-btn" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    </div>

    <div id="orders-section" style="display:none; padding: 20px;">
        <h2>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø©</h2>
        <table>
            <thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th><th>Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„</th><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</th><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th></tr></thead>
            <tbody id="admin-body"></tbody>
        </table>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBJX4iidOGIO_WiS6g-LFw89rrJ6ReInoM",
            authDomain: "zaytonaty-f4240.firebaseapp.com",
            projectId: "zaytonaty-f4240",
            appId: "1:268778198002:web:2803824e75be502f73916b"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.login = () => {
            signInWithEmailAndPassword(auth, document.getElementById('email').value, document.getElementById('pass').value)
            .catch(() => alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"));
        };

        onAuthStateChanged(auth, user => {
            if(user) {
                document.getElementById('auth-section').style.display='none';
                document.getElementById('orders-section').style.display='block';
                onSnapshot(query(collection(db, "orders"), orderBy("date", "desc")), s => {
                    document.getElementById('admin-body').innerHTML = s.docs.map(d => {
                        const o = d.data();
                        return `<tr><td>${o.date}</td><td>${o.customer_name}</td><td>${o.phone}</td><td>${o.address}</td><td>${o.items.map(i=>i.name).join(', ')}</td><td>${o.total} Ø¬.Ù…</td></tr>`;
                    }).join('');
                });
            }
        });
        document.getElementById('cart-count').innerText = (JSON.parse(localStorage.getItem('cart')) || []).length;
    </script>
</body>
</html>
